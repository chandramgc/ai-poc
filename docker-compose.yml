version: '3.8'

services:
  api:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        SCRAPER_BACKEND: bs4
    container_name: medicine-news-scraper
    ports:
      - "8000:8000"
    environment:
      # Application settings
      - DEBUG=false
      - APP_NAME=Medicine News Scraper
      
      # Scraper backend
      - SCRAPER_BACKEND=bs4
      
      # Search settings
      - MAX_RESULTS=10
      
      # HTTP request settings
      - REQUEST_TIMEOUT=10
      - REQUEST_DELAY=2.0
      
      # Cache settings
      - CACHE_TTL=3600
      - CACHE_MAX_SIZE=100
      
      # Retry settings
      - MAX_RETRIES=3
      - RETRY_BACKOFF_FACTOR=2.0
    
    restart: unless-stopped
    
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/api/v1/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
    
    # Resource limits (optional, adjust as needed)
    # deploy:
    #   resources:
    #     limits:
    #       cpus: '1'
    #       memory: 512M
    #     reservations:
    #       cpus: '0.5'
    #       memory: 256M
